var CategoryController=function(CategoryModel,$stateParams){
	this.model=CategoryModel.model;
	
	CategoryModel.getCategories().then(function(){;
		CategoryModel.getCategory($stateParams.id);
	});
}
var CategoryModel=function($http,$q){
	this.$http=$http;
	this.$q=$q;
	this.url="data/categories-data.js";
	this.model={};


}

CategoryModel.prototype.getCategories=function(){
	var deferred=this.$q.defer();
	var service=this;
	this.$http.get(this.url)
		.success(function(data){
			deferred.resolve(service.transformResponse(data));
	});
	return deferred.promise;

};

CategoryModel.prototype.transformResponse=function(categoryObj){
	var service=this;
	var categories=[];
	angular.forEach(categoryObj.categories,function(ob,key){
		categories.push(new category(ob));	
	});
	this.model.categories=categories;

};

CategoryModel.prototype.getCategory=function(id){
	var service=this;
	angular.forEach(service.model.categories,function(ob,key){
		if(typeof ob!=="undefined" && ob.id == id)
			service.model.selectedCategory=ob;
	});
};

var category=function(data){
	    if(typeof data !== "undefined"){
		this.id=data.id;
		this.image=data.image;
		this.category=data.category;
	    }

};
var HomeController=function(){



}
var ProductController=function(ProductCatalog,$stateParams){
this.model=ProductCatalog.model;
ProductCatalog.getSelectedProduct($stateParams.id);

	this.addToCart=function(){
		ProductCatalog.addToCart();
	}
}
var ProductCatalogController=function(ProductCatalog,$stateParams){
this.model=ProductCatalog.model;
ProductCatalog.getProducts().then(function(){
	ProductCatalog.getProductList($stateParams.id+$stateParams.type);
});

};
var ProductCatalog=function($http,$q,shoppingBasketService){
	this.$http=$http;
	this.$q=$q;
	this.url="data/products-data.js";
	this.model={};
	this.shoppingBasketService=shoppingBasketService;

};

ProductCatalog.prototype.getProducts=function(){
	var deferred=this.$q.defer();
	var service=this;
	this.$http.get(this.url)
		.success(function(data){
			deferred.resolve(service.transformResponse(data));
	});
	return deferred.promise;
};
ProductCatalog.prototype.transformResponse=function(productsObj){
	var service=this;
	var products=[];
	angular.forEach(productsObj.ProductList,function(ob,key){
		products.push(new product(ob));	
	});
	this.model.productList=products;

};

ProductCatalog.prototype.getProductList=function(productId){
	var service=this;
	angular.forEach(this.model.productList,function(ob,key){
		if(productId === ob.productId)
			service.model.selectedProducts=ob.products;	
	});

};
ProductCatalog.prototype.getSelectedProduct=function(id){
	var service=this;
	angular.forEach(this.model.selectedProducts,function(ob,key){
		if(key === Number(id))
			service.model.selectedProduct=ob;	
	});


};
ProductCatalog.prototype.addToCart=function(){
	this.shoppingBasketService.addToCart(this.model.selectedProduct);

};
var product=function(obj){
	if(typeof obj!=="undefined"){
		this.productId=obj.id+obj.type;
		this.products=obj.Products;
		
		
	}
}
function shoppingBasket(shoppingBasketService){

return{
	restrict:'A',
	scope:{
		
	},
	templateUrl:'templates/shoppingBasket.html',
	link:function($scope, element,attributes){
		 $scope.basket=shoppingBasketService.basket;
		 
		 $scope.removeItem=function(index){
			shoppingBasketService.removeItem(index);
			$scope.products=shoppingBasketService.products;
		}
	}
}

}
var shoppingBasketService=function(){
	this.basket={};
	this.products=[];
	this.total=0;
	
};

shoppingBasketService.prototype.addToCart=function(obj){
  if(obj.stock > 0){
	this.products.push(new BasketItem(obj));
	this.total+=obj.price;
	this.basket.products=this.products;
	this.basket.total=this.total;
  }
};

shoppingBasketService.prototype.removeItem=function(index){
	var tempArray=[];
	var total=0;
	angular.forEach(this.products,function(ob,key){
		
		if(key !== index){
			tempArray.push(ob);
			total+=ob.price;
		}
	});
	this.basket.products=tempArray;
	this.basket.total=total;

};
var BasketItem=function(obj){
	this.item=obj;
}
angular.module('ClothingFashionApp.Categories',[])
.service('CategoryModel',CategoryModel)
.controller('CategoryController',CategoryController);

angular.module('ClothingFashionApp.home',[])
.controller('HomeController',HomeController);

angular.module('ClothingFashionApp.Products',['ui.router'])
.config(function($stateProvider, $urlRouterProvider) {
    
    $urlRouterProvider.otherwise('/products');
    
    $stateProvider
        .state('products', {
            url: '/products/:id/:type',
            templateUrl: 'templates/Products.html'
        })
		.state('product', {
            url: '/product/:id',
            templateUrl: 'templates/Product.html'
        })
       
})
.service("ProductCatalog",ProductCatalog)
.controller("ProductCatalogController",ProductCatalogController)
.controller("ProductController",ProductController);

angular.module('ShoppingBasket',[])
.service('shoppingBasketService',shoppingBasketService)
.directive('shoppingBasket',shoppingBasket);
// Intializing Quiz app
var ClothingFashionApp=angular.module('ClothingFashion', ['ui.router',
'ClothingFashionApp.home',
'ClothingFashionApp.Categories',
'ClothingFashionApp.Products',
'ShoppingBasket'
]);
// Ui router for routing to different stages
ClothingFashionApp.config(function($stateProvider, $urlRouterProvider) {
    
    $urlRouterProvider.otherwise('/home');
    
    $stateProvider
        .state('home', {
            url: '/home',
            templateUrl: 'templates/home.html'
        })
      	 .state('categories', {
            url: '/categories/:id',
            templateUrl: 'templates/categories.html'
        })	
        
});


//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNhdGVnb3JpZXMtbW9kdWxlL2NvbnRyb2xsZXIvY2F0ZWdvcnlDb250cm9sbGVyLmpzIiwiQ2F0ZWdvcmllcy1tb2R1bGUvbW9kZWxzL0NhdGVnb3J5TW9kZWwuanMiLCJGYXNoaW9uSG9tZS1tb2R1bGUvY29udHJvbGxlcnMvSG9tZUNvbnRyb2xsZXIuanMiLCJQcm9kdWN0cy1tb2R1bGUvY29udHJvbGxlci9Qcm9kdWN0Q29udHJvbGxlci5qcyIsIlByb2R1Y3RzLW1vZHVsZS9jb250cm9sbGVyL1Byb2R1Y3RzQ29udHJvbGxlci5qcyIsIlByb2R1Y3RzLW1vZHVsZS9tb2RlbHMvUHJvZHVjdHNDYXRhbG9nLmpzIiwic2hvcHBpbmdiYXNrZXQtbW9kdWxlL2RpcmVjdGl2ZXMvc2hvcHBpbmdCYXNrZXQuanMiLCJzaG9wcGluZ2Jhc2tldC1tb2R1bGUvc2VydmljZXMvc2hvcHBpbmdCYXNrZXRTZXJ2aWNlLmpzIiwiQ2F0ZWdvcmllcy1tb2R1bGUvYXBwLmpzIiwiRmFzaGlvbkhvbWUtbW9kdWxlL2FwcC5qcyIsIlByb2R1Y3RzLW1vZHVsZS9hcHAuanMiLCJzaG9wcGluZ2Jhc2tldC1tb2R1bGUvYXBwLmpzIiwiYXBwLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNoQ0E7QUFDQTtBQUNBO0FBQ0E7QUNIQTtBQUNBO0FBQ0E7QUNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbkJBO0FBQ0E7QUFDQTtBQ0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgQ2F0ZWdvcnlDb250cm9sbGVyPWZ1bmN0aW9uKENhdGVnb3J5TW9kZWwsJHN0YXRlUGFyYW1zKXtcclxuXHR0aGlzLm1vZGVsPUNhdGVnb3J5TW9kZWwubW9kZWw7XHJcblx0XHJcblx0Q2F0ZWdvcnlNb2RlbC5nZXRDYXRlZ29yaWVzKCkudGhlbihmdW5jdGlvbigpeztcclxuXHRcdENhdGVnb3J5TW9kZWwuZ2V0Q2F0ZWdvcnkoJHN0YXRlUGFyYW1zLmlkKTtcclxuXHR9KTtcclxufSIsInZhciBDYXRlZ29yeU1vZGVsPWZ1bmN0aW9uKCRodHRwLCRxKXtcclxuXHR0aGlzLiRodHRwPSRodHRwO1xyXG5cdHRoaXMuJHE9JHE7XHJcblx0dGhpcy51cmw9XCJkYXRhL2NhdGVnb3JpZXMtZGF0YS5qc1wiO1xyXG5cdHRoaXMubW9kZWw9e307XHJcblxyXG5cclxufVxyXG5cclxuQ2F0ZWdvcnlNb2RlbC5wcm90b3R5cGUuZ2V0Q2F0ZWdvcmllcz1mdW5jdGlvbigpe1xyXG5cdHZhciBkZWZlcnJlZD10aGlzLiRxLmRlZmVyKCk7XHJcblx0dmFyIHNlcnZpY2U9dGhpcztcclxuXHR0aGlzLiRodHRwLmdldCh0aGlzLnVybClcclxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpe1xyXG5cdFx0XHRkZWZlcnJlZC5yZXNvbHZlKHNlcnZpY2UudHJhbnNmb3JtUmVzcG9uc2UoZGF0YSkpO1xyXG5cdH0pO1xyXG5cdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG5cclxufTtcclxuXHJcbkNhdGVnb3J5TW9kZWwucHJvdG90eXBlLnRyYW5zZm9ybVJlc3BvbnNlPWZ1bmN0aW9uKGNhdGVnb3J5T2JqKXtcclxuXHR2YXIgc2VydmljZT10aGlzO1xyXG5cdHZhciBjYXRlZ29yaWVzPVtdO1xyXG5cdGFuZ3VsYXIuZm9yRWFjaChjYXRlZ29yeU9iai5jYXRlZ29yaWVzLGZ1bmN0aW9uKG9iLGtleSl7XHJcblx0XHRjYXRlZ29yaWVzLnB1c2gobmV3IGNhdGVnb3J5KG9iKSk7XHRcclxuXHR9KTtcclxuXHR0aGlzLm1vZGVsLmNhdGVnb3JpZXM9Y2F0ZWdvcmllcztcclxuXHJcbn07XHJcblxyXG5DYXRlZ29yeU1vZGVsLnByb3RvdHlwZS5nZXRDYXRlZ29yeT1mdW5jdGlvbihpZCl7XHJcblx0dmFyIHNlcnZpY2U9dGhpcztcclxuXHRhbmd1bGFyLmZvckVhY2goc2VydmljZS5tb2RlbC5jYXRlZ29yaWVzLGZ1bmN0aW9uKG9iLGtleSl7XHJcblx0XHRpZih0eXBlb2Ygb2IhPT1cInVuZGVmaW5lZFwiICYmIG9iLmlkID09IGlkKVxyXG5cdFx0XHRzZXJ2aWNlLm1vZGVsLnNlbGVjdGVkQ2F0ZWdvcnk9b2I7XHJcblx0fSk7XHJcbn07XHJcblxyXG52YXIgY2F0ZWdvcnk9ZnVuY3Rpb24oZGF0YSl7XHJcblx0ICAgIGlmKHR5cGVvZiBkYXRhICE9PSBcInVuZGVmaW5lZFwiKXtcclxuXHRcdHRoaXMuaWQ9ZGF0YS5pZDtcclxuXHRcdHRoaXMuaW1hZ2U9ZGF0YS5pbWFnZTtcclxuXHRcdHRoaXMuY2F0ZWdvcnk9ZGF0YS5jYXRlZ29yeTtcclxuXHQgICAgfVxyXG5cclxufTsiLCJ2YXIgSG9tZUNvbnRyb2xsZXI9ZnVuY3Rpb24oKXtcclxuXHJcblxyXG5cclxufSIsInZhciBQcm9kdWN0Q29udHJvbGxlcj1mdW5jdGlvbihQcm9kdWN0Q2F0YWxvZywkc3RhdGVQYXJhbXMpe1xyXG50aGlzLm1vZGVsPVByb2R1Y3RDYXRhbG9nLm1vZGVsO1xyXG5Qcm9kdWN0Q2F0YWxvZy5nZXRTZWxlY3RlZFByb2R1Y3QoJHN0YXRlUGFyYW1zLmlkKTtcclxuXHJcblx0dGhpcy5hZGRUb0NhcnQ9ZnVuY3Rpb24oKXtcclxuXHRcdFByb2R1Y3RDYXRhbG9nLmFkZFRvQ2FydCgpO1xyXG5cdH1cclxufSIsInZhciBQcm9kdWN0Q2F0YWxvZ0NvbnRyb2xsZXI9ZnVuY3Rpb24oUHJvZHVjdENhdGFsb2csJHN0YXRlUGFyYW1zKXtcclxudGhpcy5tb2RlbD1Qcm9kdWN0Q2F0YWxvZy5tb2RlbDtcclxuUHJvZHVjdENhdGFsb2cuZ2V0UHJvZHVjdHMoKS50aGVuKGZ1bmN0aW9uKCl7XHJcblx0UHJvZHVjdENhdGFsb2cuZ2V0UHJvZHVjdExpc3QoJHN0YXRlUGFyYW1zLmlkKyRzdGF0ZVBhcmFtcy50eXBlKTtcclxufSk7XHJcblxyXG59OyIsInZhciBQcm9kdWN0Q2F0YWxvZz1mdW5jdGlvbigkaHR0cCwkcSxzaG9wcGluZ0Jhc2tldFNlcnZpY2Upe1xyXG5cdHRoaXMuJGh0dHA9JGh0dHA7XHJcblx0dGhpcy4kcT0kcTtcclxuXHR0aGlzLnVybD1cImRhdGEvcHJvZHVjdHMtZGF0YS5qc1wiO1xyXG5cdHRoaXMubW9kZWw9e307XHJcblx0dGhpcy5zaG9wcGluZ0Jhc2tldFNlcnZpY2U9c2hvcHBpbmdCYXNrZXRTZXJ2aWNlO1xyXG5cclxufTtcclxuXHJcblByb2R1Y3RDYXRhbG9nLnByb3RvdHlwZS5nZXRQcm9kdWN0cz1mdW5jdGlvbigpe1xyXG5cdHZhciBkZWZlcnJlZD10aGlzLiRxLmRlZmVyKCk7XHJcblx0dmFyIHNlcnZpY2U9dGhpcztcclxuXHR0aGlzLiRodHRwLmdldCh0aGlzLnVybClcclxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpe1xyXG5cdFx0XHRkZWZlcnJlZC5yZXNvbHZlKHNlcnZpY2UudHJhbnNmb3JtUmVzcG9uc2UoZGF0YSkpO1xyXG5cdH0pO1xyXG5cdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG59O1xyXG5Qcm9kdWN0Q2F0YWxvZy5wcm90b3R5cGUudHJhbnNmb3JtUmVzcG9uc2U9ZnVuY3Rpb24ocHJvZHVjdHNPYmope1xyXG5cdHZhciBzZXJ2aWNlPXRoaXM7XHJcblx0dmFyIHByb2R1Y3RzPVtdO1xyXG5cdGFuZ3VsYXIuZm9yRWFjaChwcm9kdWN0c09iai5Qcm9kdWN0TGlzdCxmdW5jdGlvbihvYixrZXkpe1xyXG5cdFx0cHJvZHVjdHMucHVzaChuZXcgcHJvZHVjdChvYikpO1x0XHJcblx0fSk7XHJcblx0dGhpcy5tb2RlbC5wcm9kdWN0TGlzdD1wcm9kdWN0cztcclxuXHJcbn07XHJcblxyXG5Qcm9kdWN0Q2F0YWxvZy5wcm90b3R5cGUuZ2V0UHJvZHVjdExpc3Q9ZnVuY3Rpb24ocHJvZHVjdElkKXtcclxuXHR2YXIgc2VydmljZT10aGlzO1xyXG5cdGFuZ3VsYXIuZm9yRWFjaCh0aGlzLm1vZGVsLnByb2R1Y3RMaXN0LGZ1bmN0aW9uKG9iLGtleSl7XHJcblx0XHRpZihwcm9kdWN0SWQgPT09IG9iLnByb2R1Y3RJZClcclxuXHRcdFx0c2VydmljZS5tb2RlbC5zZWxlY3RlZFByb2R1Y3RzPW9iLnByb2R1Y3RzO1x0XHJcblx0fSk7XHJcblxyXG59O1xyXG5Qcm9kdWN0Q2F0YWxvZy5wcm90b3R5cGUuZ2V0U2VsZWN0ZWRQcm9kdWN0PWZ1bmN0aW9uKGlkKXtcclxuXHR2YXIgc2VydmljZT10aGlzO1xyXG5cdGFuZ3VsYXIuZm9yRWFjaCh0aGlzLm1vZGVsLnNlbGVjdGVkUHJvZHVjdHMsZnVuY3Rpb24ob2Isa2V5KXtcclxuXHRcdGlmKGtleSA9PT0gTnVtYmVyKGlkKSlcclxuXHRcdFx0c2VydmljZS5tb2RlbC5zZWxlY3RlZFByb2R1Y3Q9b2I7XHRcclxuXHR9KTtcclxuXHJcblxyXG59O1xyXG5Qcm9kdWN0Q2F0YWxvZy5wcm90b3R5cGUuYWRkVG9DYXJ0PWZ1bmN0aW9uKCl7XHJcblx0dGhpcy5zaG9wcGluZ0Jhc2tldFNlcnZpY2UuYWRkVG9DYXJ0KHRoaXMubW9kZWwuc2VsZWN0ZWRQcm9kdWN0KTtcclxuXHJcbn07XHJcbnZhciBwcm9kdWN0PWZ1bmN0aW9uKG9iail7XHJcblx0aWYodHlwZW9mIG9iaiE9PVwidW5kZWZpbmVkXCIpe1xyXG5cdFx0dGhpcy5wcm9kdWN0SWQ9b2JqLmlkK29iai50eXBlO1xyXG5cdFx0dGhpcy5wcm9kdWN0cz1vYmouUHJvZHVjdHM7XHJcblx0XHRcclxuXHRcdFxyXG5cdH1cclxufSIsImZ1bmN0aW9uIHNob3BwaW5nQmFza2V0KHNob3BwaW5nQmFza2V0U2VydmljZSl7XHJcblxyXG5yZXR1cm57XHJcblx0cmVzdHJpY3Q6J0EnLFxyXG5cdHNjb3BlOntcclxuXHRcdFxyXG5cdH0sXHJcblx0dGVtcGxhdGVVcmw6J3RlbXBsYXRlcy9zaG9wcGluZ0Jhc2tldC5odG1sJyxcclxuXHRsaW5rOmZ1bmN0aW9uKCRzY29wZSwgZWxlbWVudCxhdHRyaWJ1dGVzKXtcclxuXHRcdCAkc2NvcGUuYmFza2V0PXNob3BwaW5nQmFza2V0U2VydmljZS5iYXNrZXQ7XHJcblx0XHQgXHJcblx0XHQgJHNjb3BlLnJlbW92ZUl0ZW09ZnVuY3Rpb24oaW5kZXgpe1xyXG5cdFx0XHRzaG9wcGluZ0Jhc2tldFNlcnZpY2UucmVtb3ZlSXRlbShpbmRleCk7XHJcblx0XHRcdCRzY29wZS5wcm9kdWN0cz1zaG9wcGluZ0Jhc2tldFNlcnZpY2UucHJvZHVjdHM7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG59IiwidmFyIHNob3BwaW5nQmFza2V0U2VydmljZT1mdW5jdGlvbigpe1xyXG5cdHRoaXMuYmFza2V0PXt9O1xyXG5cdHRoaXMucHJvZHVjdHM9W107XHJcblx0dGhpcy50b3RhbD0wO1xyXG5cdFxyXG59O1xyXG5cclxuc2hvcHBpbmdCYXNrZXRTZXJ2aWNlLnByb3RvdHlwZS5hZGRUb0NhcnQ9ZnVuY3Rpb24ob2JqKXtcclxuICBpZihvYmouc3RvY2sgPiAwKXtcclxuXHR0aGlzLnByb2R1Y3RzLnB1c2gobmV3IEJhc2tldEl0ZW0ob2JqKSk7XHJcblx0dGhpcy50b3RhbCs9b2JqLnByaWNlO1xyXG5cdHRoaXMuYmFza2V0LnByb2R1Y3RzPXRoaXMucHJvZHVjdHM7XHJcblx0dGhpcy5iYXNrZXQudG90YWw9dGhpcy50b3RhbDtcclxuICB9XHJcbn07XHJcblxyXG5zaG9wcGluZ0Jhc2tldFNlcnZpY2UucHJvdG90eXBlLnJlbW92ZUl0ZW09ZnVuY3Rpb24oaW5kZXgpe1xyXG5cdHZhciB0ZW1wQXJyYXk9W107XHJcblx0dmFyIHRvdGFsPTA7XHJcblx0YW5ndWxhci5mb3JFYWNoKHRoaXMucHJvZHVjdHMsZnVuY3Rpb24ob2Isa2V5KXtcclxuXHRcdFxyXG5cdFx0aWYoa2V5ICE9PSBpbmRleCl7XHJcblx0XHRcdHRlbXBBcnJheS5wdXNoKG9iKTtcclxuXHRcdFx0dG90YWwrPW9iLnByaWNlO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdHRoaXMuYmFza2V0LnByb2R1Y3RzPXRlbXBBcnJheTtcclxuXHR0aGlzLmJhc2tldC50b3RhbD10b3RhbDtcclxuXHJcbn07XHJcbnZhciBCYXNrZXRJdGVtPWZ1bmN0aW9uKG9iail7XHJcblx0dGhpcy5pdGVtPW9iajtcclxufSIsImFuZ3VsYXIubW9kdWxlKCdDbG90aGluZ0Zhc2hpb25BcHAuQ2F0ZWdvcmllcycsW10pXG4uc2VydmljZSgnQ2F0ZWdvcnlNb2RlbCcsQ2F0ZWdvcnlNb2RlbClcbi5jb250cm9sbGVyKCdDYXRlZ29yeUNvbnRyb2xsZXInLENhdGVnb3J5Q29udHJvbGxlcik7XG4iLCJhbmd1bGFyLm1vZHVsZSgnQ2xvdGhpbmdGYXNoaW9uQXBwLmhvbWUnLFtdKVxuLmNvbnRyb2xsZXIoJ0hvbWVDb250cm9sbGVyJyxIb21lQ29udHJvbGxlcik7XG4iLCJhbmd1bGFyLm1vZHVsZSgnQ2xvdGhpbmdGYXNoaW9uQXBwLlByb2R1Y3RzJyxbJ3VpLnJvdXRlciddKVxuLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL3Byb2R1Y3RzJyk7XG4gICAgXG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgLnN0YXRlKCdwcm9kdWN0cycsIHtcbiAgICAgICAgICAgIHVybDogJy9wcm9kdWN0cy86aWQvOnR5cGUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvUHJvZHVjdHMuaHRtbCdcbiAgICAgICAgfSlcblx0XHQuc3RhdGUoJ3Byb2R1Y3QnLCB7XG4gICAgICAgICAgICB1cmw6ICcvcHJvZHVjdC86aWQnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvUHJvZHVjdC5odG1sJ1xuICAgICAgICB9KVxuICAgICAgIFxufSlcbi5zZXJ2aWNlKFwiUHJvZHVjdENhdGFsb2dcIixQcm9kdWN0Q2F0YWxvZylcbi5jb250cm9sbGVyKFwiUHJvZHVjdENhdGFsb2dDb250cm9sbGVyXCIsUHJvZHVjdENhdGFsb2dDb250cm9sbGVyKVxuLmNvbnRyb2xsZXIoXCJQcm9kdWN0Q29udHJvbGxlclwiLFByb2R1Y3RDb250cm9sbGVyKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdTaG9wcGluZ0Jhc2tldCcsW10pXHJcbi5zZXJ2aWNlKCdzaG9wcGluZ0Jhc2tldFNlcnZpY2UnLHNob3BwaW5nQmFza2V0U2VydmljZSlcclxuLmRpcmVjdGl2ZSgnc2hvcHBpbmdCYXNrZXQnLHNob3BwaW5nQmFza2V0KTsiLCIvLyBJbnRpYWxpemluZyBRdWl6IGFwcFxudmFyIENsb3RoaW5nRmFzaGlvbkFwcD1hbmd1bGFyLm1vZHVsZSgnQ2xvdGhpbmdGYXNoaW9uJywgWyd1aS5yb3V0ZXInLFxuJ0Nsb3RoaW5nRmFzaGlvbkFwcC5ob21lJyxcbidDbG90aGluZ0Zhc2hpb25BcHAuQ2F0ZWdvcmllcycsXG4nQ2xvdGhpbmdGYXNoaW9uQXBwLlByb2R1Y3RzJyxcbidTaG9wcGluZ0Jhc2tldCdcbl0pO1xuLy8gVWkgcm91dGVyIGZvciByb3V0aW5nIHRvIGRpZmZlcmVudCBzdGFnZXNcbkNsb3RoaW5nRmFzaGlvbkFwcC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgIFxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9ob21lJyk7XG4gICAgXG4gICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICAgICAgdXJsOiAnL2hvbWUnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvaG9tZS5odG1sJ1xuICAgICAgICB9KVxuICAgICAgXHQgLnN0YXRlKCdjYXRlZ29yaWVzJywge1xuICAgICAgICAgICAgdXJsOiAnL2NhdGVnb3JpZXMvOmlkJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2NhdGVnb3JpZXMuaHRtbCdcbiAgICAgICAgfSlcdFxuICAgICAgICBcbn0pO1xuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=